<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MorseQuery - Real-time Audio Search</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>MorseQuery</h1>
            <p class="subtitle">Real-time Audio Streaming Search</p>
        </header>

        <!-- Video Layout: Left video, Right search results -->
        <div id="videoLayout" style="display: none;">
            <div style="display: flex; gap: 24px; margin-bottom: 20px;">
                <div style="flex: 2; min-width: 0;">
                    <div class="video-player-section">
                        <h3>Video Player</h3>
                        <video id="videoPlayer" controls style="width: 100%; max-height: 700px; margin-bottom: 10px;"></video>
                        <div class="button-group" style="display: flex; gap: 10px;">
                            <button id="playVideoBtn" class="btn btn-primary" style="flex: 1;">
                                <span class="icon">‚ñ∂Ô∏è</span> Play & Transcribe
                            </button>
                            <button id="stopVideoBtn" class="btn btn-warning" style="flex: 1;">
                                <span class="icon">‚èπÔ∏è</span> Stop
                            </button>
                        </div>
                    </div>
                </div>
                <div style="flex: 1; min-width: 0;">
                    <div class="search-section" id="videoSearchSection">
                        <h3>Search Results for: <span id="videoSearchKeyword"></span></h3>
                        <div id="videoSearchResults" class="search-results" style="max-height: 700px; overflow-y: auto;">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Default Layout: Search results and transcription -->
        <div id="defaultLayout">
            <div class="search-section" id="searchSection" style="display: none;">
                <h3>Search Results for: <span id="searchKeyword"></span></h3>
                <div id="searchResults" class="search-results">
                </div>
            </div>

            <div class="transcription-section">
                <h3>Live Transcription</h3>
                <div id="transcription" class="transcription-box">
                </div>
            </div>

            <div class="audio-player-section" id="audioPlayerSection" style="display: none;">
                <h3>Audio Player</h3>
                <audio id="audioPlayer" controls style="width: 100%; margin-bottom: 10px;"></audio>
                <div class="button-group" style="display: flex; gap: 10px;">
                    <button id="playBtn" class="btn btn-primary" style="flex: 1;">
                        <span class="icon">‚ñ∂Ô∏è</span> Play & Transcribe
                    </button>
                    <button id="stopAudioBtn" class="btn btn-warning" style="flex: 1;">
                        <span class="icon">‚èπÔ∏è</span> Stop
                    </button>
                </div>
            </div>
        </div>

        <div class="info-box">
            <p><strong>Instructions:</strong> Press <kbd>SPACEBAR</kbd> anytime to search for the most relevant keyword from your transcription!</p>
            <p id="status">Status: Ready</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <h3>Audio Source</h3>
                <div class="button-group">
                    <button id="micBtn" class="btn btn-primary">
                        <span class="icon">üé§</span> Microphone
                    </button>
                    <label for="fileInput" class="btn btn-secondary">
                        <span class="icon">üìÅ</span> Upload File
                        <input type="file" id="fileInput" accept="audio/*,video/*" style="display: none;">
                    </label>
                </div>
            </div>

            <div class="control-group">
                <h3>Speech Recognition</h3>
                <div class="button-group">
                    <button id="whisperBtn" class="btn btn-info active">
                        <span class="icon">üîä</span> Whisper (Local)
                    </button>
                    <button id="geminiBtn" class="btn btn-info">
                        <span class="icon">‚ú®</span> Gemini Live
                    </button>
                    <label for="srtInput" class="btn btn-info">
                        <span class="icon">üìù</span> Load SRT
                        <input type="file" id="srtInput" accept=".srt" style="display: none;">
                    </label>
                </div>
            </div>

            <div class="control-group">
                <h3>Search Mode</h3>
                <div class="button-group">
                    <button id="instantSearchBtn" class="btn btn-info">
                        <span class="icon">‚ö°</span> Instant Word
                    </button>
                    <button id="recentSearchBtn" class="btn btn-info">
                        <span class="icon">‚è±Ô∏è</span> Recent (5s)
                    </button>
                    <button id="tfidfSearchBtn" class="btn btn-info">
                        <span class="icon">üéØ</span> Important Word
                    </button>
                    <button id="gptSearchBtn" class="btn btn-info active">
                        <span class="icon">ü§ñ</span> GPT 4o mini
                    </button>
                    <button id="geminiSearchBtn" class="btn btn-info">
                        <span class="icon">‚ú®</span> Gemini Terms
                    </button>
                </div>
            </div>

            <div class="control-group">
                <h3>Search Type</h3>
                <div class="button-group">
                    <button id="textSearchBtn" class="btn btn-success active">
                        <span class="icon">üìù</span> Text Only
                    </button>
                    <button id="imageSearchBtn" class="btn btn-success">
                        <span class="icon">üñºÔ∏è</span> Image Only
                    </button>
                    <button id="bothSearchBtn" class="btn btn-success">
                        <span class="icon">üìùüñºÔ∏è</span> Text+Image
                    </button>
                </div>
            </div>

            <div class="control-group">
                <h3>Options</h3>
                <div class="button-group">
                    <button id="toggleSearchResultsBtn" class="btn btn-secondary active">
                        <span class="icon">üîç</span> Search Results
                    </button>
                    <button id="showAllKeywordsBtn" class="btn btn-secondary">
                        <span class="icon">üìã</span> Show All Keywords
                    </button>
                </div>
            </div>

            <div class="control-group">
                <button id="clearBtn" class="btn btn-warning">
                    <span class="icon">üóëÔ∏è</span> Clear Session
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
